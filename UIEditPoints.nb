(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     33098,        708]
NotebookOptionsPosition[     32570,        690]
NotebookOutlinePosition[     33005,        707]
CellTagsIndexPosition[     32962,        704]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"punti", "=", 
       RowBox[{"N", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "50"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"300", ",", "50"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"300", ",", "200"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"50", ",", "200"}], "}"}]}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mode", "=", "\"\<none\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"selectedPointIndex", "=", "None"}], ",", "\[IndentingNewLine]", 
      RowBox[{"imgSize", "=", 
       RowBox[{"{", 
        RowBox[{"353", ",", "253"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"img", "=", 
       RowBox[{
       "Import", 
        "[", "\"\<C:\\\\Users\\\\menca\\\\Desktop\\\\Universit\[AGrave]\\\\\
matyh\\\\groundtruth01\\\\unogt94.jpg\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"filePath", "=", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"$TemporaryDirectory", ",", "\"\<punti_salvati.wdx\>\""}], 
         "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"clickThreshold", "=", "10.0"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"--", 
          RowBox[{"-", 
           RowBox[{"Controlli", "--"}]}]}], "-"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Modalit\[AGrave]: \>\"", ",", "Bold"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PopupMenu", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Dynamic", "[", "mode", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<none\>\"", "->", "\"\<Nessuna\>\""}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<edit\>\"", "->", "\"\<Modifica punti\>\""}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<add\>\"", "->", "\"\<Aggiungi punto\>\""}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<remove\>\"", "->", "\"\<Rimuovi punto\>\""}]}], 
               "}"}], ",", 
              RowBox[{"Appearance", "->", "\"\<Button\>\""}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"Spacer", "[", "10", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"-", "Grafica"}]}], " ", 
           RowBox[{"Interattiva", "--"}]}], "-"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"EventHandler", "[", 
         RowBox[{
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"1.", " ", "Immagine", " ", "Sfondo"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{"img", ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Left", ",", "Bottom"}], "}"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"2.", " ", "Poligono"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "punti", "]"}], ">=", "3"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Darker", "@", "Green"}], ",", "Thick", ",", 
                    RowBox[{"Opacity", "[", "1.0", "]"}]}], "}"}], "]"}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"FaceForm", "[", "None", "]"}], ",", 
                   RowBox[{"Polygon", "[", "punti", "]"}]}], 
                  "\[IndentingNewLine]", "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"3.", " ", "Punti", " ", "base"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"Switch", "[", 
                RowBox[{"mode", ",", "\[IndentingNewLine]", "\"\<edit\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
                   RowBox[{"Darker", "@", "Blue"}], ",", 
                   RowBox[{"Point", "[", "punti", "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", "\"\<add\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
                   RowBox[{"Darker", "@", "Blue"}], ",", 
                   RowBox[{"Point", "[", "punti", "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", "\"\<remove\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
                   RowBox[{"Darker", "@", "Blue"}], ",", 
                   RowBox[{"Point", "[", "punti", "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", "_", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Medium", "]"}], ",", "Red", ",", 
                   RowBox[{"Point", "[", "punti", "]"}]}], "}"}]}], "]"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "4.", " ", "Evidenzia", " ", "punto", " ", "selezionato"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mode", "===", "\"\<edit\>\""}], "&&", 
                  RowBox[{"IntegerQ", "[", "selectedPointIndex", "]"}], "&&", 
                  RowBox[{"1", "<=", "selectedPointIndex", "<=", 
                   RowBox[{"Length", "[", "punti", "]"}]}]}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"Blue", ",", "\[IndentingNewLine]", 
                   RowBox[{"PointSize", "[", "Large", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Point", "[", 
                    RowBox[{"punti", "[", 
                    RowBox[{"[", "selectedPointIndex", "]"}], "]"}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"imgSize", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"imgSize", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "->", "imgSize"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRangePadding", "->", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageMargins", "->", "0"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"--", 
              RowBox[{"-", "Gestori"}]}], " ", "Eventi", " ", 
             RowBox[{"Mouse", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<MouseDown\>\"", ":>", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pt", "=", 
                  RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], ",",
                  "idx", ",", "dist"}], "}"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pt", "===", "None"}], ",", 
                  RowBox[{"Return", "[", "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pt", "=", 
                 RowBox[{"N", "[", "pt", "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Switch", "[", 
                 RowBox[{"mode", ",", "\[IndentingNewLine]", "\"\<edit\>\"", ",", 
                  RowBox[{
                   RowBox[{"idx", "=", 
                    RowBox[{"SelectFirst", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "punti", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"pt", ",", 
                    RowBox[{"punti", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "<", 
                    "clickThreshold"}], ")"}], "&"}], ",", "None"}], "]"}]}], 
                   ";", "\[IndentingNewLine]", "\t", 
                   RowBox[{"selectedPointIndex", "=", "idx"}], ";"}], ",", 
                  "\[IndentingNewLine]", "\"\<add\>\"", ",", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "punti", "]"}], ">=", "2"}], ",", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "distances", ",", "minSegmentIdx", ",", "insertPos"}], 
                    "}"}], ",", 
                    RowBox[{
                    RowBox[{"distances", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"RegionDistance", "[", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"punti", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"punti", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "punti", "]"}]}], "]"}], "+", 
                    "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", "pt"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "punti", "]"}]}], "}"}]}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"minSegmentIdx", "=", 
                    RowBox[{
                    RowBox[{"Ordering", "[", 
                    RowBox[{"distances", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"insertPos", "=", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"minSegmentIdx", ",", 
                    RowBox[{"Length", "[", "punti", "]"}]}], "]"}], "+", 
                    "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"punti", "=", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"punti", ",", "pt", ",", "insertPos"}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"selectedPointIndex", "=", "None"}], ";"}]}], 
                    "]"}]}], "]"}], ";"}], ",", 
                  "\[IndentingNewLine]", "\"\<remove\>\"", ",", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "punti", "]"}], ">", "3"}], ",", 
                    RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "nearestIdxList", "}"}], ",", 
                    RowBox[{
                    RowBox[{"nearestIdxList", "=", 
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"punti", "->", "\"\<Index\>\""}], ",", "pt", ",", 
                    "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "nearestIdxList", "]"}], ">", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"idx", "=", 
                    RowBox[{"First", "@", "nearestIdxList"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"dist", "=", 
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{
                    RowBox[{"punti", "[", 
                    RowBox[{"[", "idx", "]"}], "]"}], ",", "pt"}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"dist", "<", "clickThreshold"}], ",", 
                    RowBox[{
                    RowBox[{"punti", "=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"punti", ",", "idx"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"selectedPointIndex", "=", "None"}], ";"}]}], 
                    "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], 
                   ";"}], ",", "_", ",", 
                  RowBox[{
                   RowBox[{"selectedPointIndex", "=", "None"}], ";"}]}], 
                 "]"}]}]}], "]"}]}], ",", 
            RowBox[{"\"\<MouseDragged\>\"", ":>", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"pt", "=", 
                 RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
                "}"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"pt", "=!=", "None"}], "&&", 
                  RowBox[{"selectedPointIndex", "=!=", "None"}]}], ",", 
                 RowBox[{"punti", "=", 
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{"punti", ",", 
                    RowBox[{"selectedPointIndex", "->", "pt"}]}], "]"}]}]}], 
                "]"}]}], "]"}]}], ",", 
            RowBox[{"\"\<MouseUp\>\"", ":>", 
             RowBox[{"(", 
              RowBox[{"selectedPointIndex", "=", "None"}], ")"}]}]}], "}"}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"-", "Pulsante"}]}], " ", 
           RowBox[{"Salva", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Salva punti\>\"", ",", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{"filePath", ",", "punti"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"CreateDialog", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"TextCell", "[", 
               RowBox[{"\"\<Punti salvati in:\\n\>\"", "<>", "filePath"}], 
               "]"}], ",", 
              RowBox[{"DefaultButton", "[", "]"}]}], "}"}], "]"}]}], ",", 
          RowBox[{"Method", "->", "\"\<Queued\>\""}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Alignment", "->", "Center"}]}], "]"}]}], "]"}], 
  "\n"}]], "Input",
 CellChangeTimes->{{3.9533513703694706`*^9, 3.9533513703694706`*^9}, {
   3.9533515135492725`*^9, 3.953351986807686*^9}, {3.953352025934616*^9, 
   3.953352075839548*^9}, {3.9533521124742184`*^9, 3.9533521471906433`*^9}, 
   3.953352211771885*^9, {3.953353216348398*^9, 3.9533532453628044`*^9}, {
   3.9533533431294594`*^9, 3.953353406283165*^9}, {3.953353564237772*^9, 
   3.953353591068884*^9}, {3.9533537027354794`*^9, 3.953353706192316*^9}, {
   3.9549983878282604`*^9, 3.9549984348553333`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"3c459e53-a271-7f40-9cbc-e09e5d207aa8"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`punti$$ = {{112.36363636363635`, 
  192.37475142045457`}, {135.81818181818178`, 178.73838778409095`}, {
  153.27272727272722`, 165.10021306818135`}, {162.54545454545456`, 
  156.3729403409086}, {172.9090909090909, 140.5547585227268}, {
  176.7272727272727, 130.1911221590904}, {180., 118.19112215909041`}, {
  187.6363636363636, 120.37294034090857`}, {194.18181818181813`, 
  129.10021306818132`}, {196.36363636363635`, 140.00930397727222`}, {
  199.6363636363636, 153.1002130681813}, {200.18181818181816`, 
  164.5547585227268}, {190.9090909090909, 169.46384943181766`}, {
  173.45454545454547`, 176.00930397727225`}, {160.36363636363635`, 
  180.91839488636313`}, {141.8181818181818, 185.82748579545404`}, {
  127.09090909090905`, 197.2820312499995}, {106.36363636363635`, 
  201.64566761363588`}}, $CellContext`mode$$ = 
  "edit", $CellContext`selectedPointIndex$$ = None, $CellContext`imgSize$$ = {
  353, 253}, $CellContext`img$$ = Image[CompressedData["
1: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
   "], "Byte", ColorSpace -> "Grayscale", ImageResolution -> {72, 72}, 
   Interleaving -> None, 
   MetaInformation -> <|
    "Exif" -> <|
      "ImageWidth" -> 353, "ImageLength" -> 253, "XResolution" -> 72, 
       "YResolution" -> 72, "ResolutionUnit" -> "Inch", "Software" -> 
       "Created with the Wolfram Language : www.wolfram.com", "DateTime" -> 
       DateObject[{2025, 4, 10, 16, 22, 39.}, "Instant", "Gregorian", 2.], 
       "TimeZoneOffset" -> 2|>|>], $CellContext`filePath$$ = 
  "C:\\Users\\menca\\AppData\\Local\\Temp\\punti_salvati.wdx", \
$CellContext`clickThreshold$$ = 10.}, 
  TagBox[GridBox[{
     {
      TemplateBox[{
        TemplateBox[{10}, "Spacer1"], 
        StyleBox["\"Modalit\[AGrave]: \"", Bold, StripOnInput -> False], 
        PopupMenuBox[
         Dynamic[$CellContext`mode$$], {
         "none" -> "\"Nessuna\"", "edit" -> "\"Modifica punti\"", "add" -> 
          "\"Aggiungi punto\"", "remove" -> "\"Rimuovi punto\""}, Appearance -> 
         "Button"]},
       "RowWithSeparator"]},
     {
      TagBox[
       GraphicsBox[{InsetBox[
          FormBox[
           GraphicsBox[
            TagBox[RasterBox[CompressedData["
1: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
              "], {{0, 253.}, {353., 0}}, {0, 255},
              ColorFunction->GrayLevel,
              ImageResolution->{72, 72}],
             BoxForm`ImageTag[
             "Byte", ColorSpace -> "Grayscale", Interleaving -> None, 
              MetaInformation -> <|
               "Exif" -> <|
                 "ImageWidth" -> 353, "ImageLength" -> 253, "XResolution" -> 
                  72, "YResolution" -> 72, "ResolutionUnit" -> "Inch", 
                  "Software" -> 
                  "Created with the Wolfram Language : www.wolfram.com", 
                  "DateTime" -> 
                  DateObject[{2025, 4, 10, 16, 22, 39.}, "Instant", 
                    "Gregorian", 2.], "TimeZoneOffset" -> 2|>|>],
             Selectable->False],
            DefaultBaseStyle->"ImageGraphics",
            ImageSizeRaw->{353., 253.},
            PlotRange->{{0, 353.}, {0, 253.}}],
           TraditionalForm], Scaled[{0, 0}], {Left, Bottom}, Scaled[{1, 1}]], 
         DynamicBox[Typeset`ToBoxes[
           If[Length[$CellContext`punti$$] >= 3, {
             EdgeForm[{
               Darker[Green], Thick, 
               Opacity[1.]}], 
             FaceForm[None], 
             Polygon[$CellContext`punti$$]}, {}], StandardForm, Graphics],
          
          ImageSizeCache->{{113.4367626399111, 
           223.76323736008888`}, {-89.37603529574929, 9.550439424428504}}], 
         DynamicBox[Typeset`ToBoxes[
           Switch[$CellContext`mode$$, "edit", {
             PointSize[Medium], 
             Darker[Blue], 
             Point[$CellContext`punti$$]}, "add", {
             PointSize[Medium], 
             Darker[Blue], 
             Point[$CellContext`punti$$]}, "remove", {
             PointSize[Medium], 
             Darker[Blue], 
             Point[$CellContext`punti$$]}, 
            Blank[], {
             PointSize[Medium], Red, 
             Point[$CellContext`punti$$]}], StandardForm, Graphics],
          
          ImageSizeCache->{{114.52499999999999`, 
           222.675}, {-88.28779793566041, 8.462202064339616}}], 
         DynamicBox[Typeset`ToBoxes[
           If[
            And[$CellContext`mode$$ === "edit", 
             IntegerQ[$CellContext`selectedPointIndex$$], 
             1 <= $CellContext`selectedPointIndex$$ <= 
             Length[$CellContext`punti$$]], {Blue, 
             PointSize[Large], 
             Point[
              
              Part[$CellContext`punti$$, \
$CellContext`selectedPointIndex$$]]}, {}], StandardForm, Graphics],
          
          ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
           4.503599627370496*^15, -4.503599627370496*^15}}]},
        AspectRatio->Automatic,
        ImageMargins->0,
        ImageSize->{353, 253},
        PlotRange->{{0, 353}, {0, 253}},
        PlotRangePadding->None],
       EventHandlerTag[{
        "MouseDown" :> 
         Module[{$CellContext`pt$ = 
            MousePosition["Graphics"], $CellContext`idx$, $CellContext`dist$},
            If[$CellContext`pt$ === None, 
             Return[]]; $CellContext`pt$ = N[$CellContext`pt$]; 
           Switch[$CellContext`mode$$, "edit", $CellContext`idx$ = SelectFirst[
                Range[
                 Length[$CellContext`punti$$]], 
                EuclideanDistance[$CellContext`pt$, 
                  
                  Part[$CellContext`punti$$, #]] < \
$CellContext`clickThreshold$$& , 
                None]; $CellContext`selectedPointIndex$$ = $CellContext`idx$; 
             Null, "add", If[Length[$CellContext`punti$$] >= 2, 
               
               Module[{$CellContext`distances$, $CellContext`minSegmentIdx$, \
$CellContext`insertPos$}, $CellContext`distances$ = Table[
                   RegionDistance[
                    Line[{
                    Part[$CellContext`punti$$, $CellContext`i], 
                    Part[$CellContext`punti$$, Mod[$CellContext`i, 
                    Length[$CellContext`punti$$]] + 
                    1]}], $CellContext`pt$], {$CellContext`i, 
                    
                    Length[$CellContext`punti$$]}]; \
$CellContext`minSegmentIdx$ = Part[
                   Ordering[$CellContext`distances$, 1], 
                   1]; $CellContext`insertPos$ = 
                 Mod[$CellContext`minSegmentIdx$, 
                    Length[$CellContext`punti$$]] + 1; $CellContext`punti$$ = 
                 Insert[$CellContext`punti$$, $CellContext`pt$, \
$CellContext`insertPos$]; $CellContext`selectedPointIndex$$ = None; Null]]; 
             Null, "remove", 
             If[Length[$CellContext`punti$$] > 3, 
               Module[{$CellContext`nearestIdxList$}, \
$CellContext`nearestIdxList$ = 
                  Nearest[$CellContext`punti$$ -> "Index", $CellContext`pt$, 
                    1]; If[Length[$CellContext`nearestIdxList$] > 
                   0, $CellContext`idx$ = 
                    First[$CellContext`nearestIdxList$]; $CellContext`dist$ = 
                    EuclideanDistance[
                    
                    Part[$CellContext`punti$$, $CellContext`idx$], \
$CellContext`pt$]; 
                   If[$CellContext`dist$ < $CellContext`clickThreshold$$, \
$CellContext`punti$$ = 
                    Delete[$CellContext`punti$$, $CellContext`idx$]; \
$CellContext`selectedPointIndex$$ = None; Null]; Null]; Null]; Null]; Null, 
             Blank[], $CellContext`selectedPointIndex$$ = None; Null]], 
         "MouseDragged" :> 
         Module[{$CellContext`pt$ = MousePosition["Graphics"]}, 
           If[
            
            And[$CellContext`pt$ =!= None, $CellContext`selectedPointIndex$$ =!= 
             None], $CellContext`punti$$ = 
            ReplacePart[$CellContext`punti$$, \
$CellContext`selectedPointIndex$$ -> $CellContext`pt$]]], 
         "MouseUp" :> ($CellContext`selectedPointIndex$$ = None), Method -> 
         "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]},
     {
      ButtonBox["\<\"Salva punti\"\>",
       Appearance->Automatic,
       ButtonFunction:>(Export[$CellContext`filePath$$, $CellContext`punti$$]; 
        CreateDialog[{
           TextCell["Punti salvati in:\n" <> $CellContext`filePath$$], 
           DefaultButton[]}]),
       Evaluator->Automatic,
       Method->"Queued"]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Center}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.953351371761141*^9, 3.9533523278608856`*^9, 3.953352665568964*^9, 
   3.9533532503939114`*^9, 3.953353345809078*^9, {3.953353386514105*^9, 
   3.953353407833082*^9}, {3.953353570961624*^9, 3.953353593177614*^9}, 
   3.9533537096509724`*^9, {3.954998391377901*^9, 3.954998397517727*^9}, 
   3.954998455283495*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"3c41eea9-757b-3648-99e7-c4b8da7b6500"]
}, Open  ]]
},
WindowSize->{1141.2, 579.6},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1e633834-696c-b04a-a106-61ca0a94a2f9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 17187, 379, 1496, "Input",ExpressionUUID->"3c459e53-a271-7f40-9cbc-e09e5d207aa8"],
Cell[17766, 403, 14788, 284, 371, "Output",ExpressionUUID->"3c41eea9-757b-3648-99e7-c4b8da7b6500"]
}, Open  ]]
}
]
*)

